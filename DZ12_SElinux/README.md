#### SELinux 

### Запустить nginx на нестандартном порту 3-мя разными способами:

	1. Переключатели setsebool; 
	
	  Запускаем nginx (перед этим сменив его порт в файле /etc/nginx/nginx.conf) получаем ошибку.
	  Решение:
	  Смотрим в audit.log (grep "AVC" /var/log/audit/audit.log). В логе видим что, так как порт не стандартный то на запуск нет разрешения. Из лога берем вот это значение msg=audit(1587925794.610:1940).
	  Дальше с помощью утилиты audit2why (grep 1587925794.610:1940 /var/log/audit/audit.log | audit2why) смотрим какой переключатель отключить (setsebool -P nis_enabled 1) 

	2. Добавление нестандартного порта в имеющийся тип;  
	   
	   Решение представлено на стенде который можно с клонировать из репозитория (Стенда расположен в папке SElinux_nginx). В стенде используется парамет "public_network" который позволяет бридж интерфесом основной машины. При запуске нужно указать сетевой интерфес с которым будет мост. Так же в этой папке представлен файл с выводом и самим командами которые помогли в решении этой задачи.

	3. Формирование и установка модуля SELinux.

	   Описание:

	     1. Меняем порт с 80 на 8089 (sed -i 's/80/8089/' /etc/nginx/nginx.conf)
	     2. Пробуем запустить nginx. Не стартует.
	     3. Ищем ошибку в audit.log (grep "AVC" /var/log/audit/audit.log либо так audit2why < /var/log/audit/audit.log)
	     4. Формируем модуль (audit2allow -M nginx --debug < /var/log/audit/audit.log)
	     5. Загружаем модуль (semodule -i nginx.pp)
	     6. Запускаем nginx и проверяем (http://ip:8089) 
